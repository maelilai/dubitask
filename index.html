<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Familien-Tasks – Monatsansicht</title>

    <!-- Schrift -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
      :root{
        --bg:#f6f7fb; --card:#fff; --border:#e6e8ef; --muted:#6b7280; --text:#0f172a;
        --okbg:#ecfdf5; --okbr:#86efac; --brand:#6366f1;
        --b1:#0891b2; --b2:#10b981; --b3:#f59e0b;
        /* Filter-Highlight (rosa) */
        --hl-bg:#fce7f3; --hl-border:#f43f5e;
        /* „Jetzt“-Highlight (amber) */
        --now-bg:#fef3c7; --now-border:#f59e0b;
        --r:12px; --rx:16px; --max:1100px;
        --shadow:0 1px 2px rgba(15,23,42,.06), 0 8px 24px rgba(15,23,42,.06);
      }
      *{box-sizing:border-box} html,body{margin:0}
      body{font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;color:var(--text);background:#f6f7fb;min-height:100dvh}

      .top{background:#fff;border-bottom:1px solid var(--border)}
      .wrap{max-width:var(--max);margin:0 auto;padding:12px 16px}
      .header-row{display:flex;align-items:center;justify-content:space-between;gap:12px}
      h1{margin:0;font-size:22px;font-weight:800}
      .muted{color:var(--muted);font-size:12px;margin-top:4px}
      .container{max-width:var(--max);margin:0 auto;padding:16px}

      .hamburger{border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 10px;cursor:pointer;font-size:16px}
      .filter-chip{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--hl-border);border-radius:999px;padding:2px 8px;font-size:12px;background:var(--hl-bg)}
      .filter-chip b{font-weight:800}
      .clear-x{cursor:pointer;opacity:.7}
      .clear-x:hover{opacity:1}

      .menu{position:fixed;top:56px;right:16px;background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);padding:8px;display:none;z-index:20;min-width:220px;max-width:90vw}
      .menu.open{display:block}
      .menu-title{font-weight:800;font-size:13px;margin:4px 6px 6px}
      .menu-item{display:block;width:100%;text-align:left;border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 10px;margin:6px 0;cursor:pointer;font-size:14px}
      .menu-item:hover{background:#f8fafc}
      .menu-item.active{border-color:var(--hl-border);background:var(--hl-bg)}
      /* NEU: Jetzt-Info im Menü */
      .menu-now{border:1px dashed var(--now-border);background:var(--now-bg);border-radius:12px;padding:10px;margin:6px 0 10px}
      .menu-now h4{margin:0 0 6px;font-size:13px;font-weight:800}
      .menu-now .small{font-size:12px;color:#6b7280}
      .menu-divider{height:1px;background:#e5e7eb;margin:10px 0}

      .panel{background:var(--card);border:1px solid var(--border);border-radius:var(--rx);padding:16px;margin-bottom:14px;box-shadow:var(--shadow)}
      .title{display:flex;justify-content:space-between;align-items:baseline;gap:8px;margin-bottom:10px}
      .title h2{margin:0;font-size:18px;font-weight:800}

      .legend{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
      .chip{font-size:11px;padding:4px 8px;border:1px solid var(--border);border-radius:999px;background:#f8fafc}
      .chip.b1{border-color:#bae6fd} .chip.b2{border-color:#bbf7d0} .chip.b3{border-color:#fde68a}

      .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
      .label{font-size:13px;font-weight:600}
      .input{border:1px solid var(--border);border-radius:var(--r);padding:8px 10px;min-width:160px}
      .btn{border:1px solid var(--border);background:#fff;border-radius:var(--r);padding:8px 10px;font-size:14px;cursor:pointer}
      .btn:hover{background:#f8fafc}
      .btn.primary{border-color:var(--now-border);background:var(--now-bg);font-weight:800}
      .btn.primary.active{background:var(--now-border);color:#fff}
      .btn.small{padding:6px 8px;font-size:12px;border-radius:8px}

      .block-card{border-left:6px solid #ddd}
      .block-card.b1{border-left-color:var(--b1)}
      .block-card.b2{border-left-color:var(--b2)}
      .block-card.b3{border-left-color:var(--b3)}
      .block-grid{display:grid;grid-template-columns:2fr 1fr;gap:12px}
      @media (max-width: 900px){ .block-grid{grid-template-columns:1fr} }

      .grid-head,.grid-week{display:grid;gap:6px;grid-template-columns:130px repeat(7,1fr)}
      @media (max-width:900px){ .grid-head,.grid-week{grid-template-columns:110px repeat(7,1fr)} }
      .weeklabel{font-size:12px;color:var(--muted)}

      .cell{
        position:relative;height:34px;border:1px solid var(--border);border-radius:10px;background:#fff;font-size:12px;
        display:flex;align-items:center;justify-content:center;cursor:pointer;transition:filter .12s, opacity .12s, background .12s, border-color .12s;
      }
      .cell.disabled{background:#f3f4f6;color:#c0c4cc;cursor:not-allowed}
      .cell.done{background:var(--okbg);border-color:var(--okbr)}
      .cell.past:not(.done){background:#eef2f7;border-color:#e5e7eb;color:#95a1b1;opacity:.9}
      .cell.past.done{
        background-color:var(--okbg); border-color:var(--okbr);
        background-image: repeating-linear-gradient(45deg, rgba(2,6,23,.07) 0 6px, transparent 6px 12px);
      }
      .cell.past::after{
        content:""; position:absolute; top:2px; left:2px; width:0; height:0;
        border-top:8px solid #cbd5e1; border-right:8px solid transparent; pointer-events:none; opacity:.9;
      }
      .cell.past.done::after{ border-top-color:#a7f3d0; }

      /* Filter-Highlight (rosa) */
      .grid-week.hl{outline:2px solid var(--hl-border); background:var(--hl-bg)}
      .weekrow.hl{outline:2px solid var(--hl-border); background:var(--hl-bg); border-color:var(--hl-border)}

      /* „Jetzt“-Highlight (amber) */
      .grid-week.now{outline:3px solid var(--now-border); background:var(--now-bg)}
      .weekrow.now{outline:3px solid var(--now-border); background:var(--now-bg); border-color:var(--now-border)}
      .cell.today{
        border-color:var(--now-border);
        box-shadow:0 0 0 3px rgba(245,158,11,.2);
      }
      .cell.today::before{
        content:"Heute"; position:absolute; top:-8px; right:-8px; font-size:10px; background:var(--now-border); color:#fff;
        border-radius:6px; padding:2px 6px;
      }

      /* sanfte Puls-Markierung beim Scroll-Ziel */
      @keyframes pulseMark{
        0%{box-shadow:0 0 0 0 rgba(244,63,94,.35)}
        50%{box-shadow:0 0 0 8px rgba(244,63,94,0)}
        100%{box-shadow:0 0 0 0 rgba(244,63,94,0)}
      }
      .pulse{animation:pulseMark 1.2s ease-out 2}

      .weeklist{display:grid;gap:8px}
      .weekrow{
        display:flex;justify-content:space-between;align-items:center;
        border:1px solid var(--border);border-radius:var(--r);padding:10px 12px;background:#fff;transition:opacity .12s, background .12s, border-color .12s, color .12s;
      }
      .weekrow.past{background:#eef2f7;border-color:#e5e7eb;color:#95a1b1}
      .weekrow.past strong{color:#7a8697}

      .sw{appearance:none;width:42px;height:26px;border-radius:999px;background:#e2e8f0;position:relative;border:1px solid var(--border);cursor:pointer}
      .sw::after{content:"";position:absolute;top:2px;left:2px;width:20px;height:20px;border-radius:50%;background:#fff;box-shadow:0 1px 2px rgba(0,0,0,.1)}
      .sw:checked{background:#34d399} .sw:checked::after{left:20px}

      /* Layout mit rechter Sidebar */
      .layout{display:grid;grid-template-columns: 1.6fr 0.9fr; gap:16px; align-items:start}
      @media (max-width: 1020px){ .layout{grid-template-columns:1fr} }

      /* Donut-Charts in der Sidebar */
      .progress-panel .stat{border:1px solid var(--border);border-radius:12px;padding:12px;background:#fff;margin-bottom:10px}
      .progress-panel h3{margin:0 0 8px;font-size:14px;font-weight:800}
      .donut{width:160px;height:160px;display:grid;place-items:center;margin:6px auto}
      .kpi{display:flex;justify-content:center;gap:8px;font-size:13px}
      .kpi b{font-weight:800}
      .ring-bg{stroke:#e5e7eb;opacity:.85}
      .ring-fg{stroke-linecap:round}
      .label-center{font-size:18px;font-weight:800;fill:#0f172a}
      .label-sub{font-size:10px;fill:#6b7280}
    </style>
  </head>
  <body>
    <header class="top">
      <div class="wrap">
        <div class="header-row">
          <h1>Familien-Tasks</h1>
          <div>
            <span id="activeFilter" class="filter-chip" style="display:none">Filter: <b></b> <span class="clear-x" title="Filter entfernen">✕</span></span>
            <button id="menuBtn" class="hamburger" aria-haspopup="true" aria-expanded="false" title="Nach Name filtern">☰</button>
          </div>
        </div>
        <div id="monthTitle" class="muted"></div>
      </div>
    </header>

    <!-- Dropdown-Menü -->
    <div id="menu" class="menu" aria-hidden="true"></div>

    <main class="container" id="app"></main>

    <script src="app.js"></script>
  </body>
</html>